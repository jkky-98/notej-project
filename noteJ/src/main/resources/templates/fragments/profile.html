<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="profile">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.css">
    <style>
        .profile-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            padding: 20px;
            border-bottom: 1px solid #ddd;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            background-color: #ddd;
        }

        .profile-username {
            margin-top: 15px;
            font-size: 24px;
            font-weight: bold;
        }

        .profile-description {
            margin-top: 5px;
            font-size: 14px;
            color: #666;
        }

        .profile-icons {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .profile-icons a {
            font-size: 20px;
            color: #333;
            text-decoration: none;
        }

        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            font-size: 14px;
        }

        .profile-stats span {
            font-weight: bold;
        }

        .follow-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 14px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .follow-btn:hover {
            background-color: #0056b3;
        }
    </style>
    <div class="profile-container">
        <!-- 프로필 이미지 -->
        <img th:src="|${profileForm.profilePic != null ? '/storage/'+ profileForm.profilePic : '/storage/default/default-profile.png'}|" alt="Profile Picture" class="profile-avatar" th:field="*{profileForm.profilePic}">

        <!-- 사용자 이름 -->
        <div class="profile-username" th:text="${profileForm.username}" th:field="*{profileForm.username}">사용자 이름</div>

        <!-- 사용자 설명 -->
        <div class="profile-description" th:text="${profileForm.description}" th:field="*{profileForm.description}">사용자 설명</div>

        <!-- 소셜 아이콘 -->
        <div class="profile-icons">
            <!-- 항상 랜더링되는 socialEmail -->
            <a th:href="${profileForm.socialEmail}" title="Email" th:if="${profileForm.socialEmail}">
                <i class="bi bi-envelope"></i>
            </a>

            <!-- GitHub (값이 있을 때만 랜더링) -->
            <a th:href="${profileForm.socialGitHub}" target="_blank" title="GitHub" th:if="${profileForm.socialGitHub}">
                <i class="bi bi-github"></i>
            </a>

            <!-- Twitter (값이 있을 때만 랜더링) -->
            <a th:href="${profileForm.socialTwitter}" target="_blank" title="Twitter" th:if="${profileForm.socialTwitter}">
                <i class="bi bi-twitter"></i>
            </a>

            <!-- Facebook (값이 있을 때만 랜더링) -->
            <a th:href="${profileForm.socialFacebook}" target="_blank" title="Facebook" th:if="${profileForm.socialFacebook}">
                <i class="bi bi-facebook"></i>
            </a>

            <!-- 기타 소셜 (값이 있을 때만 랜더링) -->
            <a th:href="${profileForm.socialOther}" target="_blank" title="Other" th:if="${profileForm.socialOther}">
                <i class="bi bi-link-45deg"></i>
            </a>
        </div>

        <!-- 팔로워/팔로잉 (임시 데이터로 설정 가능) -->
        <div class="profile-stats">
            <span th:text="'팔로워: ' + ${profileForm.followers}">팔로워: 0</span>
            <span th:text="'팔로잉: ' + ${profileForm.followings}">팔로잉: 0</span>
        </div>

        <!-- 팔로우 버튼 (profileForm.username과 sessionUser.username이 다를 경우에만 표시) -->
        <div th:if="${sessionUser != null and profileForm.username != sessionUser.username}">
            <form th:action="@{/follow}" method="post">
                <input type="hidden" name="targetUsername" th:value="${profileForm.username}">
                <button type="submit" class="follow-btn" th:text="'팔로우'">팔로우</button>
            </form>
        </div>

        <!-- SweetAlert2 JS -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.10/dist/sweetalert2.min.js"></script>

        <!-- 팔로우 성공(SweetAlert2) -->
        <script th:if="${followSuccess}" th:inline="javascript">
            Swal.fire({
                icon: 'success',
                title: '팔로우 성공!',
                text: '이제 해당 사용자를 팔로우하고 있습니다.',
                confirmButtonText: '확인'
            });
        </script>
    </div>
</div>
