# notej-project

# 목차
- [개발 환경](#개발-환경)
- [사용 기술](#사용-기술)
    * [백엔드](#백엔드)
    * [프론트엔드](#프론트엔드)
    * [데이터베이스](#데이터베이스)
    * [인프라](#인프라)
    * [기타 라이브러리](#기타-라이브러리)
- [핵심 키워드](#핵심-키워드)
- [시스템 아키텍처](#시스템-아키텍처)
- [E-R Diagram](#e-r-diagram)
- [프로젝트 목적](#프로젝트-목적)
    * [기획 의도](#기획-의도)
- [핵심 기능 Before 릴리즈](#핵심-기능-before-릴리즈)
    * [게시글 CRUD](#게시글-crud)
    * [마크다운 작성을 위한 Toast Ui Editor 적용](#마크다운-작성을-위한-toast-ui-editor-적용)
    * [태그 및 키워드 검색 기능](#태그-및-키워드-검색-기능)
    * [작성 자동저장 가눙](#작성-자동저장-기능)
    * [알림 기능](#알림-기능)
    * [좋아요 및 팔로우 기능](#좋아요-및-팔로우-기능)
    * [무한 스크롤 페이징 기능](#무한-스크롤-페이징-기능)
    * [자바8 스트림 람다 문법 도입](#자바8-스트림-람다-문법-도입)
    * [사진 저장용량 최적화](#사진-저장용량-최적화)
## 개발 환경
- IntelliJ
- GitHub

## 사용 기술
### 백엔드
#### 주요 프레임워크 / 라이브러리
- Java 17 openjdk
- SpringBoot 3.4.0
- Spring Data JPA
- QueryDSL

#### 빌드 Tool
- Gradle

#### 프론트엔드
- Javascript
- Html/css
- Thymeleaf
- BootStrap5

#### 데이터베이스
- H2(dev)
- Mysql(prod)

#### 인프라
- AWS EC2
- AWS S3
- GitHub Actions
- Docker
- AWS RDS

### 기타 라이브러리
- Lombok
- Toast Ui Editor

## 핵심 키워드
- 스프링 부트를 사용하여 웹 애플리케이션 설계 ~ 배포 유지 보수까지 전 과정 개발 및 운영
- AWS / ubuntu 기반 Github action을 활용한 무중단 배포 및 배포 자동화 구축
- MVC 프레임워크 기반 백엔드 서버 구축

## 시스템 아키텍처
None

### 패키징 구조 예시

## E-R Diagram

## 프로젝트 목적

### 기획 의도

## 핵심 기능 Before 릴리즈

### 게시글 CRUD

### 마크다운 작성을 위한 Toast Ui Editor 적용

개발자 블로그답게 게시글을 마크다운으로 작성할 수 있도록 **`Toast Ui Editor`** 오픈 소스를 사용했습니다. 

![image](https://github.com/user-attachments/assets/84553641-c871-4c0e-9ab8-a5d21c33b109)
글 작성시 첨부하는 이미지와 게시글의 썸네일 이미지의 경우에는 S3에 저장되도록 하였습니다.(사진파일 저장의 생명주기를 관리하여 저장부하를 줄이도록 하였습니다.)

작성시 js async를 사용하여 비동기적으로 blob사진을 업로드 컨트롤러에 보내어 즉각적으로 저장하고 저장된 파일명을 받아 다시 다운로드 컨트롤러로 하여금 Viewer에 해당 사진을 랜더링하도록
구현하였습니다.

### 태그 및 키워드 검색 기능

### 작성 자동저장 기능

### 알림 기능
타 블로그 유저가 이용자의 게시글에 댓글을 남기거나 이용자의 게시글에 좋아요를 누르거나 이용자의 블로그 자체를 팔로우 할 수 있습니다.

해당 기능을 수행할 시 이용자는 이에 대한 알림을 받아야 합니다.

해당 기능을 수행할 시 알림 엔티티를 생성하여 알림수신자가 이를 조회할 수 있게 만들었습니다.

![image](https://github.com/user-attachments/assets/b1219a0f-5aa6-4220-95ea-c43ea27f2067)
네비게이션에서 읽지 않은 알림이 존재할 경우 빨간 숫자로 랜더링하여 이를 쉽게 알아볼 수 있도록 하였습니다.

알림을 누를 경우 알림관리 페이지로 들어갈 수 있습니다.

![image](https://github.com/user-attachments/assets/889a19eb-4bca-4111-84ed-e1091b973134)
알림페이지에서는 클릭 가능한 알림카드들이 존재하며 읽지 않았을 경우 흰색으로 읽었을 경우 회색으로 표시됩니다.

알림을 단건 클릭할 경우 읽은 것으로 처리됩니다.

(읽을 경우 네비게이션 바 알림의 수에 더 이상 포함되지 않습니다.)

알림 `모두 읽기`, `모두 삭제`를 통해 알림에 대한 처리가 가능합니다.

읽지않은 알림만 볼 수 있도록 필터 기능을 넣어두었습니다.

### 좋아요 및 팔로우 기능


### 무한 스크롤 페이징 기능
게시글 리스트 렌더링에 Pageable을 활용한 페이징 기술을 적용하였습니다.

초기 로드 시 5개의 게시글 카드를 렌더링하며, AJAX 기반의 무한 스크롤 기능을 구현하여 사용자가 스크롤을 최하단으로 내릴 경우 추가로 5개의 게시글 카드를 가져오도록 구성하였습니다.

또한, 쿼리 스트링을 통해 tagName, seriesName, search와 같은 조건별 조회 기능을 지원하며, 이를 Querydsl을 활용한 동적 조회 쿼리로 처리하여 효율적인 조건별 데이터 조회가 가능하도록 구현하였습니다.
#### 관련 작성글
[무한 스크롤 페이징 기능 구현 과정](https://velog.io/write?id=965f2736-9586-413c-812f-c9a523e860d6)

### 댓글, 대댓글 기능

### 자바8 스트림 람다 문법 도입
스트림, 람다를 학습하여 이를 프로젝트에 적용하였습니다. 적용하지 않은 코드가 존재하는데 이는 가독성을 기준으로 개발자 본인의 판단하에 결정하였습니다.

https://github.com/jkky-98/notej-project/commit/787e273dc97936401a1091940344218329c3d647

### 사진 저장용량 최적화
기존 Editor 작업에서 사진을 첨부할 때, 즉각적으로 저장소에 업로드 되어 실제 저장시 해당 사진들을 사용하지 않을 경우 저장소에 쓰지 않는 사진들이 쌓이는 경우가 발생하였습니다. 

이를 S3 객체 태그를 이용한 생명주기 관리를 통해 실제 게시글 저장 시점에 content에서 쓰이는 사진 객체에 대해 영속화 태그를 부착하고, 작성 시점 업로드된 태그에는 임시태그를 부착했습니다. 

태그의 상태관리는 PostFile이라는 엔티티를 통해 관리하여 수정시 새로운 영속화 태그를 부착하거나 기존 영속화 태그를 임시태그로 변환하는 등의 작업이 가능했습니다.

#### 관련 작성글
[사진 저장용량 최적화 구현 과정](https://velog.io/@aal2525/Toast-Editor-%EC%82%AC%EC%A7%84-%EC%A0%80%EC%9E%A5-%EC%B5%9C%EC%A0%81%ED%99%94)

#### 악성 사용자 막기

다음과 같은 극단적인 악성 사용자 시나리오를 방지하고자 짧은 시간안에 에디터 이미지 업로드가 매우 자주 들어왔을 경우 해당 컨트롤러의 접근을 1분간 막도록 구현했습니다.

요청 수를 카운트하고 상태를 안전하게 관리하기 위해, 동시성 관점에서 안전한 캐시를 제공하는 Google의 오픈소스 라이브러리인 Guava를 사용하여 상태 관리를 구현하였습니다. Guava는 동시성 제어와 자동 만료 기능을 내장하고 있어, 복잡한 로직 없이 효율적으로 요청 제한 로직을 처리할 수 있습니다.

지정한 시간동안 최대 요청수를 인자로 받는 RateLimit AOP를 설계하여 해당 기능을 다른 컨트롤러 메서드에서도 활용할 수 있게 하였습니다.

(아래의 테스트를 위한 영상으로, 1분간 5회 초과 요청이 들어올 경우 alert를 띄우는 것으로 기능을 만들었습니다. 실제 적용시에는 더욱 관대하게 적용할 것입니다.)
![화면 기록 2025-01-21 오후 4 52 14](https://github.com/user-attachments/assets/ba1dd182-5e63-439b-bffb-a5a87413510a)
